import React, { useState, useEffect } from 'react';
import { 
  Instagram, 
  Phone, 
  MessageCircle, 
  Menu as MenuIcon, 
  X, 
  Globe, 
  MapPin, 
  ExternalLink,
  ChevronRight,
  UtensilsCrossed,
  Navigation,
  Clock,
  Share2
} from 'lucide-react';

const App = () => {
  const [lang, setLang] = useState('ar');
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [scrolled, setScrolled] = useState(false);

  useEffect(() => {
    const handleScroll = () => {
      setScrolled(window.scrollY > 20);
    };
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const googleMapsUrl = "https://maps.app.goo.gl/7e1CQY99FTfgcVzY7";
  const logoUrl = "https://cdn.jsdelivr.net/gh/my-land/majboos_alhashi@main/ma-logo.jpg";

  const content = {
    ar: {
      name: "مجبوس الحاشي",
      slogan: "على الماشي اخذلك نفر حاشي",
      address: "النجف الاشرف - شارع ملحق الروان",
      status: "مفتوح الآن",
      links: {
        instagram: "انستغرام",
        menu: "قائمة الطعام",
        call: "اتصال",
        whatsapp: "واتساب",
        location: "الموقع الجغرافي"
      },
      menu: {
        title: "قائمة الطعام",
        currency: "د.ع",
        sections: [
          { title: "الأطباق الرئيسية", items: [
            { name: "نفر مجبوس حاشي", price: "18,000" },
            { name: "نفر مقلقل حاشي (صالة)", price: "18,000" },
            { name: "نفر مجبوس روبيان (الأربعاء)", price: "16,000" },
            { name: "بخاري دجاج كامل", price: "16,000" },
            { name: "نصف بخاري دجاج", price: "9,000" },
          ]},
          { title: "المقبلات والمشروبات", items: [
            { name: "مقبلات صالة", price: "4,000" },
            { name: "مقبلات سفري", price: "3,000" },
            { name: "لبن بارد", price: "1,000" },
            { name: "بيبسي", price: "750" },
          ]}
        ]
      },
      footer: {
        cta: "هل تريد موقعاً مثل هذا؟",
        contact: "تواصل معنا"
      }
    },
    en: {
      name: "Majboos Alhashi",
      slogan: "Traditional Taste, Modern Speed",
      address: "Najaf - Al-Rawan St.",
      status: "Open Now",
      links: {
        instagram: "Instagram",
        menu: "Digital Menu",
        call: "Call Us",
        whatsapp: "WhatsApp",
        location: "Directions"
      },
      menu: {
        title: "Menu",
        currency: "IQD",
        sections: [
          { title: "Main Course", items: [
            { name: "Majboos Hashi", price: "18,000" },
            { name: "Mugalgal Hashi", price: "18,000" },
            { name: "Shrimp Majboos (Wed)", price: "16,000" },
            { name: "Full Chicken Bukhari", price: "16,000" },
            { name: "Half Chicken Bukhari", price: "9,000" },
          ]},
          { title: "Sides & Drinks", items: [
            { name: "Appetizers", price: "4,000" },
            { name: "Takeaway Apps", price: "3,000" },
            { name: "Cold Laban", price: "1,000" },
            { name: "Pepsi", price: "750" },
          ]}
        ]
      },
      footer: {
        cta: "Need a page like this?",
        contact: "Contact Lanlink"
      }
    }
  };

  const t = content[lang];
  const isRtl = lang === 'ar';

  return (
    <div className={`min-h-screen bg-[#FAF9F6] text-[#201A19] font-sans transition-colors duration-500 overflow-x-hidden ${isRtl ? 'rtl' : 'ltr'}`} dir={isRtl ? 'rtl' : 'ltr'}>
      
      {/* M3 Background Pattern - More Subtle */}
      <div className="fixed inset-0 pointer-events-none opacity-[0.03]" 
           style={{ backgroundImage: `url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 0 L100 50 L50 100 L0 50 Z' fill='%235A2D23'/%3E%3C/svg%3E")`, backgroundSize: '60px 60px' }} 
      />

      {/* Top App Bar - M3 Style */}
      <nav className={`fixed top-0 inset-x-0 z-50 transition-all duration-300 px-6 h-16 flex items-center justify-between ${scrolled ? 'bg-[#FAF9F6]/80 backdrop-blur-md' : ''}`}>
        <button 
          onClick={() => setLang(lang === 'ar' ? 'en' : 'ar')}
          className="h-10 px-4 bg-[#5A2D23] text-[#FFDBCF] rounded-full flex items-center gap-2 text-sm font-medium shadow-sm active:scale-95 transition-all"
        >
          <Globe size={18} />
          {lang === 'ar' ? 'EN' : 'عربي'}
        </button>
        <button className="w-10 h-10 flex items-center justify-center rounded-full text-[#5A2D23] hover:bg-[#5A2D23]/10 transition-colors">
          <Share2 size={20} />
        </button>
      </nav>

      <main className="relative max-w-md mx-auto px-6 pt-24 pb-20">
        
        {/* Hero Section */}
        <section className="flex flex-col items-center text-center mb-10">
          <div className="relative mb-6">
            <div className="w-40 h-40 rounded-[2.5rem] bg-white p-1 shadow-md overflow-hidden border border-[#5A2D23]/10">
              <img src={logoUrl} alt="Logo" className="w-full h-full object-cover rounded-[2.2rem]" />
            </div>
            <div className="absolute -bottom-2 inset-x-0 flex justify-center">
              <span className="bg-[#EADDFF] text-[#21005D] px-3 py-1 rounded-full text-[10px] font-bold tracking-tight shadow-sm border border-white">
                {t.status}
              </span>
            </div>
          </div>

          <h1 className="text-3xl font-black text-[#5A2D23] mb-1">{t.name}</h1>
          <p className="text-[#8D5C4E] font-medium text-base mb-4 opacity-80">{t.slogan}</p>
          
          <a href={googleMapsUrl} target="_blank" className="flex items-center gap-2 text-[#5A2D23]/60 text-xs font-bold bg-[#5A2D23]/5 px-4 py-2 rounded-full">
            <MapPin size={14} />
            {t.address}
          </a>
        </section>

        {/* Buttons - Material 3 Tonal & Contained */}
        <div className="space-y-3">
          
          {/* High-emphasis: Menu */}
          <button 
            onClick={() => setIsMenuOpen(true)}
            className="w-full flex items-center justify-between bg-[#5A2D23] text-[#FFDBCF] p-5 rounded-[2rem] shadow-md hover:shadow-lg active:scale-[0.98] transition-all"
          >
            <div className="flex items-center gap-4">
              <div className="w-12 h-12 bg-[#FFDBCF] text-[#5A2D23] rounded-2xl flex items-center justify-center">
                <UtensilsCrossed size={24} />
              </div>
              <span className="text-lg font-black tracking-tight uppercase">{t.links.menu}</span>
            </div>
            <ChevronRight size={20} className={isRtl ? 'rotate-180' : ''} />
          </button>

          {/* Medium-emphasis: Links */}
          <LinkButton 
            href="https://www.instagram.com/majboos_alhashi/" 
            icon={<Instagram size={22} />} 
            label={t.links.instagram} 
            theme="tonal"
          />
          
          <LinkButton 
            href={googleMapsUrl} 
            icon={<Navigation size={22} />} 
            label={t.links.location} 
            theme="tonal"
          />

          {/* Grid for small actions */}
          <div className="grid grid-cols-2 gap-3">
            <LinkButton 
              href="tel:07855663374" 
              icon={<Phone size={20} />} 
              label={t.links.call} 
              theme="outline"
            />
            <LinkButton 
              href="https://wa.me/9647855663374" 
              icon={<MessageCircle size={20} />} 
              label={t.links.whatsapp} 
              theme="outline"
            />
          </div>

        </div>

        {/* Footer */}
        <footer className="mt-16 text-center">
          <div className="bg-[#FFDBCF]/30 border border-[#5A2D23]/10 p-8 rounded-[2.5rem] mb-10">
            <p className="text-[#5A2D23] text-sm font-bold mb-4">{t.footer.cta}</p>
            <a 
              href="https://my-land.github.io/lanlink/" 
              target="_blank" 
              className="inline-flex items-center gap-2 bg-[#5A2D23] text-[#FFDBCF] px-6 py-3 rounded-full font-black text-sm transition-transform active:scale-95"
            >
              {t.footer.contact} <ExternalLink size={16} />
            </a>
          </div>
          
          <p className="text-[10px] font-black text-[#5A2D23]/40 uppercase tracking-[0.4em] mb-1">
            Majboos Alhashi
          </p>
          <a href="https://my-land.github.io/lanlink/" className="text-[11px] font-bold text-[#5A2D23]/60 hover:text-[#5A2D23]">
            DESIGNED BY LANLINK
          </a>
        </footer>

      </main>

      {/* Menu Side Sheet / Modal */}
      {isMenuOpen && (
        <div className="fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-0 sm:p-4">
          <div className="absolute inset-0 bg-[#201A19]/60 backdrop-blur-sm" onClick={() => setIsMenuOpen(false)} />
          
          <div className="relative bg-[#FAF9F6] w-full max-w-md h-[85vh] sm:h-auto sm:max-h-[85vh] rounded-t-[2.5rem] sm:rounded-[2.5rem] flex flex-col overflow-hidden animate-in slide-in-from-bottom duration-300">
            
            {/* Grab Handle */}
            <div className="w-10 h-1 bg-[#5A2D23]/10 rounded-full mx-auto mt-3 mb-2" />

            <div className="px-8 py-4 flex items-center justify-between">
              <h2 className="text-2xl font-black text-[#5A2D23]">{t.menu.title}</h2>
              <button onClick={() => setIsMenuOpen(false)} className="w-10 h-10 flex items-center justify-center bg-[#5A2D23]/5 text-[#5A2D23] rounded-full">
                <X size={20} />
              </button>
            </div>

            <div className="flex-1 overflow-y-auto px-8 pb-10 scrollbar-hide">
              {t.menu.sections.map((section, sIdx) => (
                <div key={sIdx} className="mb-8">
                  <h3 className="text-[10px] font-black text-[#8D5C4E] uppercase tracking-[0.2em] mb-4 flex items-center gap-3">
                    {section.title}
                    <div className="flex-1 h-[1px] bg-[#5A2D23]/5" />
                  </h3>
                  <div className="space-y-2">
                    {section.items.map((item, idx) => (
                      <div key={idx} className="flex justify-between items-center p-4 bg-white rounded-2xl border border-[#5A2D23]/5">
                        <div>
                          <p className="font-bold text-[#201A19] text-base">{item.name}</p>
                          {item.tag && <span className="text-[9px] font-black text-[#5A2D23] bg-[#FFDBCF] px-2 py-0.5 rounded-full mt-1 inline-block">{item.tag}</span>}
                        </div>
                        <div className="flex items-center gap-1 font-black text-[#5A2D23] text-lg">
                          <span>{item.price}</span>
                          <span className="text-[9px] opacity-60">{t.menu.currency}</span>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      )}

    </div>
  );
};

const LinkButton = ({ href, icon, label, theme }) => {
  const themes = {
    tonal: "bg-[#5A2D23]/5 text-[#5A2D23] border border-transparent",
    outline: "bg-transparent text-[#5A2D23] border border-[#5A2D23]/20"
  };

  return (
    <a 
      href={href} 
      target="_blank" 
      className={`flex items-center gap-4 p-4 rounded-[1.8rem] transition-all active:scale-[0.98] ${themes[theme]}`}
    >
      <div className={`w-10 h-10 flex items-center justify-center rounded-xl ${theme === 'tonal' ? 'bg-[#5A2D23] text-[#FFDBCF]' : 'bg-[#5A2D23]/10 text-[#5A2D23]'}`}>
        {icon}
      </div>
      <span className="text-sm font-black tracking-tight uppercase">{label}</span>
    </a>
  );
};

export default App;
